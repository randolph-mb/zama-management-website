# Netlify Build Configuration
[build]
  publish = "out"
  command = "npm run build"

# Aggressive Caching für Performance (Native App Feeling)
[[headers]]
  for = "/*"
  [headers.values]
    # Security Headers
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "camera=(), microphone=(), geolocation=()"

# Statische Assets: 1 Jahr Cache (immutable)
[[headers]]
  for = "/_next/static/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Bilder: 1 Jahr Cache (können sich ändern, aber selten)
[[headers]]
  for = "/assets/*.(jpg|jpeg|png|webp|gif|svg|ico)"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
    # WebP/AVIF Unterstützung signalisieren
    Vary = "Accept"

# Videos: 1 Jahr Cache (groß, sollten nicht oft neu geladen werden)
[[headers]]
  for = "/assets/*.(mp4|webm)"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
    # Range Requests für Video-Streaming
    Accept-Ranges = "bytes"

# Fonts: 1 Jahr Cache (immutable)
[[headers]]
  for = "/*.(woff|woff2|ttf|otf|eot)"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
    Access-Control-Allow-Origin = "*"

# HTML-Seiten: Kurzer Cache mit Revalidation
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# Root HTML
[[headers]]
  for = "/"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# Compression (Brotli + Gzip) - Netlify macht das automatisch
# Aber wir können es erzwingen
[[headers]]
  for = "/*"
  [headers.values]
    # Content-Encoding wird von Netlify automatisch gesetzt

# Service Worker (falls später hinzugefügt)
[[headers]]
  for = "/sw.js"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# Preload kritische Assets über HTTP/2 Server Push (experimental)
[[headers]]
  for = "/"
  [headers.values]
    Link = '''
      </assets/Zama/dentist_hand_cneumann_b25e1216ac (1).jpg>; rel=preload; as=image,
      </_next/static/css/*>; rel=preload; as=style
    '''
